<%- model_class = Project -%>
<div class="page-header">
  <h1><%=t '.title', :default => model_class.model_name.human %></h1>
</div>

<dl class="dl-horizontal">
  <dt><strong><%= model_class.human_attribute_name(:name) %>:</strong></dt>
  <dd><%= @project.name %></dd>
</dl>

<div class="form-actions">
  <%= link_to t('.back', :default => t("helpers.links.back")),
              projects_path, :class => 'btn'  %>
  <%= link_to t('.edit', :default => t("helpers.links.edit")),
              edit_project_path(@project), :class => 'btn' %>
  <%= link_to t('.destroy', :default => t("helpers.links.destroy")),
              project_path(@project),
              :method => 'delete',
              :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
              :class => 'btn btn-danger' %>
</div>

<p id="notice"><%= notice %></p>

<div class="page-header">
  <h1><%=t '.title', :default => @project.name %> (<%= @project.id %>)</h1>
</div>
<p>
  <ul>Phases:
    <% @project.phases.each do |phase| %>
      <li>
        <% if phase.id == @current_phase.id %>
          <span style="color:red;"><%= phase.type %></span>
        <% else %>
          <%= link_to phase.type, project_url(:phase => "#{phase.type.downcase}") %>
        <% end -%>,
        <% if phase.completed? %>
          <%= "Completed" %>
        <% else %>
          <%= phase.completion%>% Complete
        <% end %>
        <%= phase.id %>
      </li>
    <% end -%>
  </ul>
</p>

<p>
  <% @current_phase.posts.each do |post| %>
    <h5><%= post.title %></h5>
    <span><%= User.find(post.user_id).first_name unless post.user_id == nil %></span>
    <p><%= post.message %></p>
      <% if post.attachment? %>
        <%= link_to 'attachment', post.attachment.url %>
        <%= post.attachment.content_type %>
      <% end -%>  

    </p>
  <% end %>
</p>

<%= link_to 'Edit', edit_project_path(@project) %> |
<%= link_to 'Back', projects_path %>

<%= form_for(@post, :html => {:multipart => true}) do |f| %>
  <% if @post.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@post.errors.count, "error") %> prohibited this post from being saved:</h2>

      <ul>
      <% @post.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field">
    <%= f.label :title %><br />
    <%= f.text_field :title %>
  </div>
  <div class="field">
    <%= f.label :message %><br />
    <%= f.text_area :message %>
  </div>
  <div class="field">
    <%= f.label :attachment %><br />
    <%= f.file_field :attachment %>
  </div>
  <div class="field">
    <%= f.label :comment %><br />
    <%= f.check_box :comment %>
  </div>
  <!-- Hidden fields -->
    <%= f.hidden_field :phase_id, :value => @current_phase.id %>
    <%= f.hidden_field :user_id, :value => @current_user.id %>
  <!-- end -->
  <div class="actions">
    <%= f.submit %>
  </div>
<% end %>
